{{- define "header"}}
// Code generated by gencheck
// DO NOT EDIT!

package {{.package}}

import (
"github.com/abice/gencheck"
)
{{end -}}

{{- define "struct"}}
{{$ruleMap := .rules -}}
// Validate is an automatically generated validation method provided by
// gencheck.
// See https://github.com/abice/gencheck for more details.
func (s {{if .ptrMethod }}*{{end}}{{.name}}) Validate () (error) {
  {{/* Only make the errors map if we're going to use it. */}}
  {{- if gt (len .rules) 0 -}}
  {{if (or .globalFailFast (not .prealloc))}}
  var vErrors gencheck.ValidationErrors
  {{else}}
  vErrors := make(gencheck.ValidationErrors, 0, {{len .rules}})
  {{end}}
  {{ end }}
  {{/* Iterate through the rule map to create the rules */}}
  {{range $index, $field := .rules -}}
    {{ $name := $field.Name -}}
    {{ $rules := $field.Rules -}}
    {{ if gt (len $rules) 0 -}}
    // BEGIN {{ $name }} Validations
    {{- range $rIndex, $rule := $rules }}
      // {{ $rule.Name -}}
      {{- CallTemplate $rule $rule }}
    {{- end -}}// END {{ $name }} Validations

    {{ end }}
  {{- end}}
  {{/* Only check the errors map if we have rules. */}}
  {{ if gt (len .rules) 0 }}
  {{/* Only add check if we're not always failing fast. */}}
  {{if not .globalFailFast}}
  if len(vErrors) >0 {
    return vErrors
  }
  {{end}}
  {{- end}}
  return nil
}
{{end}}
